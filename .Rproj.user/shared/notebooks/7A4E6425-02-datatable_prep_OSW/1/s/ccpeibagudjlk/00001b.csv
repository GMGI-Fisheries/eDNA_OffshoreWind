"0","# Disagree2 <- Blast_GMGI_edited %>% group_by(ASV_ID) %>% "
"0","#   dplyr::rename(., GMGI_db_ID = db_percent_ID, GMGI_pident = pident) %>%"
"0","#   ## Creating new columns with species name based on pident information"
"0","#   mutate("
"0","#     GMGI_100 = if_else(GMGI_pident == 100, Species_name, NA),"
"0","#     GMGI_lessthan100 = if_else(GMGI_pident < 100, Species_name, NA)) %>%"
"0","#   "
"0","#   ## taking only the top hit per ASV ID"
"0","#   slice_max(GMGI_pident, n = 1, with_ties = FALSE) %>% ungroup() %>%"
"0","# "
"0","#   ## filtering to distinct rows with selected columns"
"0","#   distinct(ASV_ID, GMGI_db_ID, GMGI_pident, GMGI_100, GMGI_lessthan100) %>%"
"0","#   "
"0","#   ## adding Mitofish and editing the Blast_Mito df in the process"
"0","#   full_join(Blast_Mito %>% dplyr::select(ASV_ID, Species_name) %>%"
"0","#               dplyr::rename(Mitofish = Species_name) %>%"
"0","#               distinct() %>% group_by(ASV_ID) %>%"
"0","#               mutate(Mitofish = paste0(Mitofish, collapse = "";"")),"
"0","#             by = ""ASV_ID"") %>%"
"0","#   "
"0","#   ## adding NCBI and editing the Blast_NCBI df in the process"
"0","#   full_join(Blast_NCBI %>% dplyr::select(ASV_ID, Species_name) %>%"
"0","#               dplyr::rename(NCBI = Species_name) %>%"
"0","#               distinct() %>% group_by(ASV_ID) %>%"
"0","#               mutate(NCBI = paste0(NCBI, collapse = "";"")),"
"0","#             by = ""ASV_ID"") %>%"
"0","#   "
"0","#   ## adding ASV rank and sum information"
"0","#   left_join(., ASV_rank_list, by = ""ASV_ID"") %>%"
"0","# "
"0","#   ## filtering out duplicate rows"
"0","#   distinct() %>%"
"0","#   "
"0","#   ## filtering to those entries that mismatch between GMGI, Mitofish, and NCBI"
"0","#   filter(!(GMGI_100 %in% GMGI_lessthan100) | !(GMGI_100 %in% Mitofish) | !(GMGI_100 %in% NCBI))"
"0","# "
"0","# ## export this data frame as excel sheet "
"0","# Disagree %>% write_xlsx(path_disagree_list)"
